<div class="container mt-5">
  <h2 class="mb-4">Shopping Cart</h2>
  
  <div *ngIf="(cart$ | async) as cartItems">
    <div *ngIf="cartItems.length === 0" class="alert alert-info">
       The basket is empty.! <a routerLink="/home" class="btn btn-sm btn-primary ms-2">Back to Shopping</a>
    </div>

    <div *ngIf="cartItems.length > 0">
      <div class="table-responsive mb-4">
        <table class="table table-striped table-hover">
          <thead class="table-dark">
            <tr>
              <th>img</th>
              <th>Product Name</th>
              <th>the price</th>
              <th>Quantity</th>
              <th>Total</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of cartItems">
              <td>
                <img [src]="item.images[0]" alt="product" style="width: 50px; height: 50px; object-fit: cover; border-radius: 4px;">
              </td>
              <td>{{ item.title | slice:0:40 }}...</td>
              <td>${{ item.price }}</td>
              <td>
                <div class="d-flex align-items-center gap-2">
                  <button class="btn btn-sm btn-outline-dark" (click)="decrement(item.id)">-</button>
                  <span class="fw-bold">{{ item.quantity }}</span>
                  <button class="btn btn-sm btn-dark" (click)="increment(item.id)">+</button>
                </div>
              </td>
              <td class="fw-bold">${{ (item.price * item.quantity).toFixed(2) }}</td>
              <td>
                <button class="btn btn-sm btn-danger" (click)="decrement(item.id)" *ngIf="item.quantity === 1">حذف</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="row justify-content-end">
        <div class="col-md-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Order Summary</h5>
              <hr>
              <div class="d-flex justify-content-between mb-3">
                <span>Total:</span>
                <span class="fw-bold">
                  ${{ getTotal(cartItems) }}
                </span>
              </div>
              <button class="btn btn-success w-100 btn-lg" (click)="completeOrder()">Complete Order</button>
              <button class="btn btn-secondary w-100 mt-2" routerLink="/home">Back to Shopping</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
